---
title: "Receiver deployment locations- Walleye sources of reproduction"
date: "as of `r format(Sys.time(), '%m/%d/%Y %H:%M')` "
output:
  html_document
---

<style type="text/css">

h1.title {
	font-size: 34px;
	text-align: center;
	}
	
h4.date {
   font-size: 18px;
   text-align: center;
   }

}
   	
</style>

<br><br>

# Receiver map ("nav chart" soundings in meters)

```{r, echo = FALSE, out.width = '100%'}
tar_load(leaflet_pts)
tar_load(sbay)

# create leaflet map
m <- leaflet(height = 1000, width = 1000)
m <- setView(m, zoom = 10, lat = 43.92460, lng = -83.48373)
m <- addWMSTiles(m, "https://gis.charttools.noaa.gov/arcgis/rest/services/MCS/ENCOnline/MapServer/exts/MaritimeChartService/WMSServer", layers = c(1,2,3,4,5,6,7), options = WMSTileOptions(format = "image/png", tranparent = TRUE))
m <- addProviderTiles(m, providers$Esri.WorldImagery, group = "satellite")
m <- addProviderTiles(m, providers$Esri.NatGeoWorldMap, group = "alt")
m <- addPolygons(map = m, data = sbay, color  = "red", fillColor = NA, group = "sag bay")

# plot LWF recs
m <- addCircleMarkers(m, data = leaflet_pts[leaflet_pts$source == 2,], label = ~site, color = c("red"), radius = c(4), group = "LWF recs", stroke = FALSE, fillOpacity = 1)  

# plot bay reef receivers
m <- addCircleMarkers(m, data = leaflet_pts[leaflet_pts$source == 1,], label = ~site, color = c("blue"), radius = c(6),  group = "bay reefs", stroke = FALSE, fillOpacity = 1)

# plot receiver lines outside of SB
m <- addCircleMarkers(m, data = leaflet_pts[leaflet_pts$source == 3,], color = "purple", radius = 6, group = "proposed_walleye", label = ~site, stroke = FALSE, fillOpacity = 1)

# plot receiver grid in bay
m <- addCircleMarkers(m, data = leaflet_pts[leaflet_pts$source == 4,], color = "yellow", radius = 6, group = "grid_10km", label = ~site, stroke = FALSE, fillOpacity = 1)
m <- leafem::addMouseCoordinates(m)
m <- addMeasure(m, primaryLengthUnit = "meters", secondaryLengthUnit = "kilometers")  
m <- addLayersControl(m, baseGroups = c("satellite", "nav chart", "alt"), overlayGroups = c("LWF recs", "bay reefs", "proposed_walleye", "grid_10km", "sag bay"), position = "bottomright", options = layersControlOptions(collapsed = FALSE))
m

```
<br><br>

# Coordinates

```{r, echo = FALSE, warning = FALSE, message = FALSE}

coords <- as.data.table(st_coordinates(leaflet_pts))
out <- data.table(site = leaflet_pts$site, glatos_array = leaflet_pts$glatos_array, station_no = leaflet_pts$station_no, depth_ft = round(leaflet_pts$chart_depth_ft, 1), lon = coords$X, lat = coords$Y, deployment = leaflet_pts$dep_type)
out <- out[!.("YTZ"), on = "glatos_array"]
out[, ID := 1:nrow(out)]

coords_table(out_tbl = out)

fwrite(out, "output/WA_sag_bay_recs_2022.csv")

# see links below for info about customizing output.
# https://babichmorrowc.github.io/post/changing-fonts-in-rmarkdown-pdfs/
# used flextable to style table

```





